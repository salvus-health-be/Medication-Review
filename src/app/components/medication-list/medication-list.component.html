<div class="medication-list-container">
  <div class="header">
    <h2 class="title">{{ 'medication.medication_list' | transloco }}</h2>
    <div class="actions">
      <button class="import-button" (click)="importMedications()">{{ 'common.import' | transloco }}</button>
      <button class="add-button" (click)="addMedication()">
        <span class="plus-icon">+</span> {{ 'common.add' | transloco }}
      </button>
      <button class="delete-all-button" (click)="deleteAllMedications()">
        {{ 'medication.delete_all' | transloco }}
      </button>
    </div>
  </div>

  <div class="medications-scroll" #medicationsScroll>
    <app-medication-item 
      #medicationItems
      *ngFor="let medication of medications; let last = last" 
      [medication]="medication"
      [isNew]="medication.isNew === true"
      (medicationDeleted)="onMedicationDeleted($event)"
      (editRequested)="onEditRequested($event)">
    </app-medication-item>
  </div>
</div>

<!-- Medication Search Modal -->
<app-medication-search-modal 
  *ngIf="showSearchModal" 
  [isEditMode]="editingMedication !== null"
  (close)="onModalClose()" 
  (medicationSelected)="onMedicationSelected($event)"
></app-medication-search-modal>

<!-- CNK Selection Modal -->
<app-cnk-selection-modal
  *ngIf="showCnkSelectionModal && currentMedicationForCnkSelection"
  [medication]="currentMedicationForCnkSelection"
  (close)="onCnkSelectionCancelled()"
  (medicationSelected)="onCnkSelected($event)"
  (skip)="onCnkSkipped()"
></app-cnk-selection-modal>

<!-- Delete All Confirmation Modal -->
<app-confirmation-modal
  *ngIf="showDeleteAllModal"
  [title]="'medication.delete_all_confirm_title' | transloco"
  [message]="'medication.delete_all_confirm_message' | transloco"
  [confirmText]="'common.delete' | transloco"
  [cancelText]="'common.cancel' | transloco"
  (confirm)="onDeleteAllConfirmed()"
  (cancel)="onDeleteAllCancelled()"
></app-confirmation-modal>
