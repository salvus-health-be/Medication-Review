<div class="modal-overlay" (click)="onCancel()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <h2>{{ 'notes.add_note' | transloco }}</h2>

    <div class="medication-info" *ngIf="medication">
      <div class="info-row">
        <span class="info-label">{{ 'patient.name' | transloco }}:</span>
        <span class="info-value">{{ medication.name }}</span>
      </div>
      <div class="info-row" *ngIf="getFrequencyDisplay()">
        <span class="info-label">{{ 'medication.frequency' | transloco }}:</span>
        <span class="info-value">{{ getFrequencyDisplay() }}</span>
      </div>
    </div>

    <div class="form-section">
      <label for="note-text">{{ 'notes.note_text' | transloco }}:</label>
      <textarea 
        id="note-text"
        [(ngModel)]="noteText"
        [placeholder]="'notes.note_placeholder' | transloco"
        rows="6"
      ></textarea>
      
      <!-- Preset buttons -->
      <div class="preset-buttons" *ngIf="presetButtons.length > 0">
        <button 
          *ngFor="let preset of presetButtons" 
          type="button"
          class="preset-btn"
          (click)="addPresetText(preset)"
        >
          {{ preset | transloco }}
        </button>
      </div>
    </div>

    <div class="toggle-section">
      <button 
        type="button"
        class="toggle-button"
        [class.active]="addToPatientConversation"
        (click)="addToPatientConversation = !addToPatientConversation"
      >
        <span class="toggle-icon">{{ addToPatientConversation ? '✓' : '' }}</span>
        <span class="toggle-text">{{ 'notes.add_to_patient_conversation' | transloco }}</span>
      </button>

      <button 
        type="button"
        class="toggle-button"
        [class.active]="addToGpReport"
        (click)="addToGpReport = !addToGpReport"
      >
        <span class="toggle-icon">{{ addToGpReport ? '✓' : '' }}</span>
        <span class="toggle-text">{{ 'notes.add_to_gp_report' | transloco }}</span>
      </button>
    </div>

    <div class="button-row">
      <button class="btn-secondary" (click)="onCancel()">{{ 'common.cancel' | transloco }}</button>
      <button class="btn-primary" (click)="onAddToAnamnesis()">{{ 'notes.add_to_anamnesis' | transloco }}</button>
    </div>
  </div>
</div>
